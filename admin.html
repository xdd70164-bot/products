<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>1 æœˆæ´»å‹•çå‹µï½œä¸»æŒäººæ§åˆ¶</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
  background:#f6f6f6;
  padding:40px;
  text-align:center;
}
.box{
  background:#fff;
  display:inline-block;
  padding:30px 32px;
  border-radius:18px;
  box-shadow:0 8px 24px rgba(0,0,0,.08);
  min-width:280px;
}
h2{margin-top:0;}
.turn{
  font-size:42px;
  font-weight:800;
  margin:20px 0;
}
button{
  font-size:18px;
  padding:12px 20px;
  margin:8px;
  border:0;
  border-radius:12px;
  cursor:pointer;
}
.next{background:#2ecc71;color:#fff;}
.prev{background:#3498db;color:#fff;}
.reset{background:#f39c12;color:#fff;}
.danger{background:#e74c3c;color:#fff;}
small{display:block;color:#888;margin-top:10px;}
</style>
</head>

<body>

<div class="box">
  <h2>ğŸ¤ ä¸»æŒäººæ§åˆ¶å°</h2>

  <div>ç›®å‰è¼ªåˆ°</div>
  <div class="turn" id="turn">-</div>

  <button class="prev" onclick="prev()">â¬… ä¸Šä¸€ä½</button>
  <button class="next" onclick="next()">â¡ ä¸‹ä¸€ä½</button><br>

  <button class="reset" onclick="resetTurn()">ğŸ”„ é‡ç½®é †ä½</button><br>

  <button class="danger" onclick="fullReset()">âš  ä¸€éµé‡è£½ï¼ˆæ¸…ç©ºå…¨éƒ¨ï¼‰</button>

  <small>âš  ä¸€éµé‡è£½æœƒæ¸…ç©ºæ‰€æœ‰é¸çç´€éŒ„</small>
</div>

<!-- Firebase compat -->
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>

<script>
/* Firebase è¨­å®š */
const firebaseConfig = {
  apiKey: "AIzaSyBEmxW-TqnxW3pgoXc2pfatFtqSQQkqMsE",
  authDomain: "january-reward.firebaseapp.com",
  databaseURL: "https://january-reward-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "january-reward",
  storageBucket: "january-reward.appspot.com",
  messagingSenderId: "881794098293",
  appId: "1:881794098293:web:453715a4382bd6651d843c"
};

/* åˆå§‹åŒ– Firebase */
if (!firebase.apps.length) {
  firebase.initializeApp(firebaseConfig);
}
const db = firebase.database();

/* ç›®å‰é †ä½ç›£è½ */
const turnRef = db.ref("currentTurn");
turnRef.on("value", snap=>{
  document.getElementById("turn").innerText = snap.val() ?? "-";
});

/* æ§åˆ¶é †ä½ */
function next(){
  turnRef.transaction(v => (v || 1) + 1);
}
function prev(){
  turnRef.transaction(v => Math.max(1, (v || 1) - 1));
}
function resetTurn(){
  if(confirm("ç¢ºå®šè¦æŠŠé †ä½é‡ç½®ç‚ºç¬¬ 1 åï¼Ÿ")){
    turnRef.set(1);
  }
}

/* âš  ä¸€éµé‡è£½ */
function fullReset(){
  const ok = confirm(
    "âš  è­¦å‘Šï¼šæ­¤å‹•ä½œæœƒï¼š\n\n" +
    "1. æ¸…ç©ºæ‰€æœ‰äººå·²é¸çå“\n" +
    "2. é †ä½é‡è¨­ç‚ºç¬¬ 1 å\n\n" +
    "ç¢ºå®šè¦é‡è£½æ•´å ´æ´»å‹•å—ï¼Ÿ"
  );
  if(!ok) return;

  // æ¸…ç©ºé¸çç´€éŒ„
  db.ref("pickLog").remove();

  // é‡ç½®é †ä½
  turnRef.set(1);

  alert("âœ… å·²å®Œæˆä¸€éµé‡è£½\nè«‹æ‰€æœ‰äººé‡æ–°æƒæ QR Code");
}
</script>

</body>
</html>

